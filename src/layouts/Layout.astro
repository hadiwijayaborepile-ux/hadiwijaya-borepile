---
import { SEO } from 'astro-seo';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
	title: string;
  description?: string;
  keywords?: string[];
}

const { 
  title = 'Hadiwijaya Bore Pile - Jasa Bore Pile Profesional',
  description = 'Solusi fondasi bore pile terpercaya untuk semua skala proyek. Kami menyediakan jasa bore pile manual, mini crane, dan hydraulic dengan tim berpengalaman.', 
  keywords = ['jasa bore pile', 'fondasi bore pile', 'kontraktor fondasi', 'bore pile jakarta', 'bore pile indonesia', 'bore pile manual', 'bore pile mini crane', 'bore pile hydraulic']
} = Astro.props;
---

<!doctype html>
<html lang="id">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<meta name="generator" content={Astro.generator} />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />

    <SEO
      title={title}
      description={description}
      keywords={keywords}
      openGraph={{
        basic: {
          title: title,
          type: 'website',
          image: '/assets/img/og-image.jpg', 
          url: Astro.url,
        }
      }}
      extend={{
        meta: [{ name: 'twitter:card', content: 'summary_large_image' }],
        link: [{ rel: 'canonical', href: Astro.url.href }]
      }}
    />
	</head>
	<body>

		<Header/>
		<slot name="hero" />
		<main> 
			<slot/>
		</main>
		<Footer />

    <!-- Modal Form -->
    <div id="booking-modal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Pesan Layanan</h2>
        <p>Lengkapi detail di bawah ini untuk membuat pesan WhatsApp.</p>
        <form id="booking-form">
          <div class="form-group">
            <label for="modal-name">Nama Anda</label>
            <input type="text" id="modal-name" name="name" required placeholder="Masukkan nama lengkap Anda">
          </div>
          <div class="form-group">
            <label for="modal-address">Alamat Proyek</label>
            <input type="text" id="modal-address" name="address" required placeholder="Contoh: Jl. Proyek No. 1, Jakarta">
          </div>
          <div class="form-group">
            <label for="modal-phone">Nomor Telepon (WhatsApp)</label>
            <input type="tel" id="modal-phone" name="phone" required placeholder="Contoh: 08123456789">
          </div>
          <button type="submit" class="cta-button"><i class="fab fa-whatsapp"></i> Kirim via WhatsApp</button>
        </form>
      </div>
    </div>

    <a href="https://api.whatsapp.com/send/?phone=6281233624549&text=Hallo+Mas+Hadi...+Saya+mau+bikin+pondasi+bore+pile%2C+bisa+tolong+dibantu%3F&type=phone_number&app_absent=0" target="_blank" class="whatsapp-float" aria-label="WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>
    
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>

    <script is:inline>
      function initAll() {
        initNavbar();
        initStickyHeader();
        initFaq();
        initBookingModal();
        initFancybox();
      }

      function initNavbar() {
        const toggleButton = document.getElementById('mobile-menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        if (toggleButton && mobileMenu && !toggleButton.dataset.listenerAttached) {
          toggleButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('mobile-menu-hidden');
          });
          toggleButton.dataset.listenerAttached = 'true';
        }
      }

      function initStickyHeader() {
        const header = document.getElementById('main-header');
        if (!header) return;
        const handleScroll = () => {
          if (window.scrollY > 40) header.classList.add('scrolled');
          else header.classList.remove('scrolled');
        };
        handleScroll();
        if (!window.scrollListenerAttached) {
            window.addEventListener('scroll', handleScroll);
            window.scrollListenerAttached = true;
        }
      }

      function initFaq() {
        document.querySelectorAll('.accordion-item').forEach(item => {
          const header = item.querySelector('.accordion-header');
          if (header && !header.dataset.listenerAttached) {
            header.addEventListener('click', () => {
              const content = item.querySelector('.accordion-content');
              const icon = header.querySelector('.accordion-icon');
              const isOpen = item.classList.toggle('open');
              if (content) {
                content.style.maxHeight = isOpen ? content.scrollHeight + 'px' : '0';
              }
              if (icon) {
                icon.style.transform = isOpen ? 'rotate(180deg)' : 'rotate(0deg)';
              }
            });
            header.dataset.listenerAttached = 'true';
          }
        });
      }

      function initBookingModal() {
        const modal = document.getElementById("booking-modal");
        if (!modal) return;
        const form = document.getElementById("booking-form");
        const closeBtn = modal.querySelector(".close-button");
        if (!form || !closeBtn) return;
        const openModal = (serviceName) => {
          window.currentService = serviceName;
          modal.style.display = "flex";
        };
        const closeModal = () => modal.style.display = "none";
        document.querySelectorAll('[data-action="open-booking-modal"]').forEach(btn => {
          if (!btn.dataset.listenerAttached) {
            btn.addEventListener('click', () => openModal(btn.dataset.serviceName));
            btn.dataset.listenerAttached = 'true';
          }
        });
        if (!closeBtn.dataset.listenerAttached) {
          closeBtn.addEventListener('click', closeModal);
          closeBtn.dataset.listenerAttached = 'true';
        }
        if (!window.modalClickListenerAttached) {
          window.addEventListener('click', (event) => {
            if (event.target === modal) closeModal();
          });
          window.modalClickListenerAttached = true;
        }
        if (!form.dataset.listenerAttached) {
          form.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = form.querySelector("#modal-name").value;
            const address = form.querySelector("#modal-address").value;
            const phone = form.querySelector("#modal-phone").value;
            const service = window.currentService || 'Tidak spesifik';
            const message = `Halo, saya ingin memesan layanan.\n\n*Layanan:* ${service}\n*Nama:* ${name}\n*Alamat Proyek:* ${address}\n*Nomor Telepon:* ${phone}\n\nMohon informasinya. Terima kasih.`;
            const whatsappUrl = `https://wa.me/6281233624549?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            closeModal();
            form.reset();
          });
          form.dataset.listenerAttached = 'true';
        }
      }

      function initFancybox() {
        if (typeof Fancybox !== 'undefined') {
          Fancybox.destroy();
          Fancybox.bind("[data-fancybox]", { Toolbar: { display: ["close"] } });
        }
      }

      document.addEventListener('astro:page-load', initAll);
      initAll();

    </script>
	</body>
</html>

<style is:global>
	:root {
		--primary-color: #FF6B00;
		--secondary-color: #222A7A;
		--background-color: #f8f9fa;
		--text-color: #333;
    --fancybox-bg: rgba(34, 42, 122, 0.92);
    --fancybox-toolbar-color: #fff;
    --fancybox-toolbar-bg: transparent;
	}

  .hero {
    background: linear-gradient(180deg, rgba(34,42,122,0.12), rgba(34,42,122,0.04));
    padding: 4rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: white;
  }
  .hero .hero-content { max-width: 1100px; padding: 0 1rem; }
  .hero .title { font-size: 2.6rem; color: var(--secondary-color); margin: 0 0 0.75rem; }
  .hero .subtitle { color: #475569; font-size: 1.05rem; max-width: 900px; margin: 0 auto; }

  .hero--product {
    padding-top: 6rem;
    padding-bottom: 5rem;
    background: linear-gradient(180deg, rgba(34,42,122,0.02), rgba(248,249,250,0.02));
  }
  .hero--product .title { font-size: 1.35rem; color: rgba(255,255,255,0.95); margin-bottom: 0.6rem; }

  .hero--service { background: linear-gradient(90deg, rgba(34,42,122,0.14), rgba(34,42,122,0.06)); color: white; }

  .hero--blog { padding: 3.5rem 0; background: #fff; }

	html {
		font-family: system-ui, sans-serif;
		background: var(--background-color);
	}
	body {
		margin: 0;
		overflow-x: hidden;
	}
	main { 
    position: relative; 
    overflow-x: hidden;
  }
  .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
  section { padding: 5rem 0; }
  section h2 { font-size: 2.8rem; color: var(--secondary-color); margin-bottom: 3rem; text-align: center; }
  .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center; }
  .modal-content { position: relative; background-color: #fefefe; padding: 2.5rem; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.25); width: 90%; max-width: 500px; }
  .close-button { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; }
  .modal-content h2 { margin-top: 0; font-size: 2rem; text-align: left; }
  #booking-form .form-group { margin-bottom: 1.2rem; }
  #booking-form label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: #444; text-align: left; }
  #booking-form input { width: 100%; padding: 0.8rem 1rem; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
  #booking-form .cta-button { display: inline-flex; align-items: center; justify-content: center; gap: 0.75rem; width: 100%; padding: 1rem; font-size: 1.1rem; margin-top: 1rem; border: none; cursor: pointer; border-radius: 8px; font-weight: 700; background-color: var(--primary-color); color: white; }
  #booking-form .cta-button:hover { background-color: #e65200; }
  #booking-form .cta-button i { font-size: 1.2rem; }
    .whatsapp-float { position: fixed; width: 60px; height: 60px; bottom: 40px; right: 40px; background-color: #25D366; color: #FFF; border-radius: 50px; text-align: center; font-size: 38px; z-index: 1000; display: flex; align-items: center; justify-content: center; text-decoration: none; }
  
    .wysiwyg-content {
    overflow-wrap: break-word;
    word-wrap: break-word;
    overflow: hidden; /* Added to prevent overflow */
  }
  .wysiwyg-content h1, .wysiwyg-content h2, .wysiwyg-content h3 {
      color: var(--secondary-color);
      margin: 2.5rem 0 1rem;
      line-height: 1.3;
      font-weight: 600;
    }
    .wysiwyg-content h1 { font-size: 1.8em; }
    .wysiwyg-content h2 { font-size: 1.6em; }
    .wysiwyg-content h3 { font-size: 1.4em; }
    .wysiwyg-content p { margin-bottom: 1rem; line-height: 1.8; }
    .wysiwyg-content ul, .wysiwyg-content ol { margin: 1rem 0 1rem 1.5rem; }
    .wysiwyg-content li { margin-bottom: 0.75rem; line-height: 1.8; }
    .wysiwyg-content strong { font-weight: 700; }
    .wysiwyg-content em { font-style: italic; }
    .wysiwyg-content u { text-decoration: underline; }
    .wysiwyg-content a { color: var(--primary-color); text-decoration: underline; }

    /* Default (Desktop) styles for images within WYSIWYG content */
    .wysiwyg-content img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1.5rem auto; /* Center image */
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
      
  .wysiwyg-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    font-size: 0.95rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }
  .wysiwyg-content th, .wysiwyg-content td {
    border: 1px solid #ddd;
    padding: 12px 15px;
    text-align: left;
  }
  .wysiwyg-content thead tr { background-color: #f5f5f5; }
  .wysiwyg-content th { font-weight: 600; color: var(--secondary-color); }
  .wysiwyg-content tbody tr:nth-child(even) { background-color: #fafafa; }

  @media (max-width: 768px) {
    .wysiwyg-content img {
      max-width: 100% !important; /* Match blog page approach */
      height: auto !important;
      display: block !important;
      margin: 1.5rem auto !important; /* Center image on mobile */
      min-width: 0 !important;
      min-height: 0 !important;
    }
    .wysiwyg-content table,
    .wysiwyg-content tbody,
    .wysiwyg-content tr,
    .wysiwyg-content td {
      display: block;
      width: 100%;
    }
    .wysiwyg-content thead { display: none; }
    .wysiwyg-content table { box-shadow: none; border: none; }
    .wysiwyg-content tr {
      background: #fff;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      padding: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.04);
    }
    .wysiwyg-content tbody tr:nth-child(even) { background-color: #fff; }
    .wysiwyg-content td {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
      text-align: right;
      border-top: none;
    }
    .wysiwyg-content tr td:last-child { border-bottom: none; }
    .wysiwyg-content td[data-label]::before {
      content: attr(data-label);
      font-weight: 600;
      color: var(--secondary-color);
      text-align: left;
      padding-right: 1rem;
    }
  }

  </style>