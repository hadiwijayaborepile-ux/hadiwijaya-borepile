---
import Layout from './Layout.astro';
const { frontmatter, title, description, keywords } = Astro.props;

const price = frontmatter.price;
const serviceName = frontmatter.title;
const mainIcon = frontmatter.mainIcon;
const isImageIcon = mainIcon && !mainIcon.startsWith('fa-');
---

<Layout title={title} description={description} keywords={keywords}>
  <article class="service-page">

    <!-- 1. Product-style Hero Section -->
    <section class="product-hero">
      <div class="container product-grid">
        <div class="product-image">
          {isImageIcon ? (
            <img src={mainIcon} alt={frontmatter.title} class="service-icon-image" />
          ) : (
            <i class={`fas ${mainIcon || 'fa-hard-hat'}`}></i>
          )}
        </div>
        <div class="product-details">
          <h1 class="title">{frontmatter.title}</h1>
          <p class="subtitle">{frontmatter.subtitle}</p>
          
          {price && <div class="price">{price}</div>}

          <div class="key-features-list">
            <h4>Keunggulan Utama:</h4>
            <ul>
              {frontmatter.key_features.map(feature => (
                <li><i class={`fas ${feature.icon || 'fa-check-circle'}`}></i><div><strong>{feature.title}:</strong> {feature.description}</div></li>
              ))}
            </ul>
          </div>

          <button 
            class="cta-button" 
            data-action="open-booking-modal" 
            data-service-name={serviceName}
          >
            <i class="fab fa-whatsapp"></i> Book Now
          </button>
        </div>
      </div>
    </section>

    <!-- 2. Detailed Info & Process Section -->
    <section class="detailed-info">
      <div class="container grid-two">
        <div class="prose">
            <slot name="description" />
        </div>
        <div class="process-infographic">
            <h3>Proses Kerja Kami</h3>
            <ol>
                {frontmatter.process.map(step => (
                    <li>
                        <div class="step-number">{step.step}</div>
                        <div class="step-content">
                            <h4>{step.title}</h4>
                            <p>{step.description}</p>
                        </div>
                    </li>
                ))}
            </ol>
        </div>
      </div>
    </section>

    <!-- 4. Mini Gallery -->
    <section class="gallery">
        <div class="container">
            <h2>Galeri Proyek</h2>
            <div class="gallery-grid">
                {frontmatter.gallery_images.map(image => (
                    <a href={image} data-fancybox="gallery" class="gallery-item">
                        <img src={image} alt={`Galeri proyek ${frontmatter.title}`} loading="lazy" />
                    </a>
                ))}
            </div>
        </div>
    </section>

    <!-- 5. Final CTA -->
    <section class="final-cta">
      <div class="container">
        <h2>Siap Memulai Pondasi Kokoh Anda?</h2>
        <p>Diskusikan detail proyek Anda dengan tim ahli kami dan dapatkan solusi terbaik.</p>
        <a href="/contact" class="cta-button">Konsultasi Sekarang</a>
      </div>
    </section>

  </article>

  <style>
    .service-page { background-color: #fff; }

    /* 1. Product Hero Section */
    .product-hero { 
      padding: 6rem 0;
      background-color: var(--background-color);
    }
    .product-grid { 
      display: grid; 
      grid-template-columns: 1fr 1.5fr; /* Two columns */
      gap: 4rem; 
      align-items: center; 
    }
    .product-image { 
      background-color: #fff; 
      border-radius: 20px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      height: 400px; /* Use fixed height */
      box-shadow: 0 10px 30px rgba(0,0,0,0.07);
      overflow: hidden; 
      padding: 1rem;
    }
    .product-image i {
      font-size: 15rem; /* Large icon */
      color: var(--primary-color);
      text-shadow: 0 4px 15px rgba(255, 107, 0, 0.4);
    }
    .product-image img.service-icon-image {
      width: 100%;
      height: 100%;
      object-fit: contain; /* Corrected to contain */
    }

    .product-details .title { font-size: 3.2rem; font-weight: 800; color: var(--secondary-color); margin-bottom: 0.5rem; line-height: 1.2; }
    .product-details .subtitle { font-size: 1.3rem; opacity: 0.8; margin-bottom: 2rem; }
    .product-details .price { 
      font-size: 2.5rem; 
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 2rem;
    }

    .key-features-list h4 { 
      font-size: 1.2rem; 
      color: var(--secondary-color); 
      margin-bottom: 1rem; 
    }
    .key-features-list ul { 
      list-style: none; 
      padding: 0; 
      margin: 0 0 2.5rem 0;
    }
    .key-features-list li { 
      display: flex; 
      align-items: center; 
      gap: 1rem; 
      margin-bottom: 1rem; 
      font-size: 1.1rem; 
    }
    .key-features-list i { 
      color: var(--primary-color); 
      font-size: 1.4rem; 
      flex-shrink: 0; 
    }

    .product-details .cta-button { 
      background-color: var(--primary-color); 
      color: white; 
      padding: 1rem 2.5rem; 
      border-radius: 50px; 
      text-decoration: none; 
      font-size: 1.2rem; 
      font-weight: 700; 
      transition: all 0.3s ease;
      border: none; 
      cursor: pointer; 
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
    }
    .product-details .cta-button:hover { background-color: #e65200; transform: translateY(-3px); box-shadow: 0 8px 15px rgba(255, 107, 0, 0.3); }


    /* Shared Styles */
    .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
    section { padding: 5rem 0; }
    h2 { font-size: 2.8rem; color: var(--secondary-color); text-align: center; margin-bottom: 3rem; }

    /* 2. Detailed Info */
    .detailed-info { background-color: #fff; border-top: 1px solid #eee; border-bottom: 1px solid #eee; }
    .grid-two { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: flex-start; }
    .prose { font-size: 1.1rem; line-height: 1.8; color: #333; }
    .prose h2 { text-align: left; font-size: 2rem; margin-bottom: 1.5rem; }

    .process-infographic h3 { font-size: 1.8rem; color: var(--secondary-color); margin-bottom: 2rem; }
    .process-infographic ol { list-style: none; padding: 0; position: relative; border-left: 2px solid var(--primary-color); }
    .process-infographic li { position: relative; margin-bottom: 2.5rem; padding-left: 2.5rem; }
    .process-infographic .step-number { position: absolute; left: -21px; top: 0; background: var(--primary-color); color: white; width: 40px; height: 40px; border-radius: 50%; display: grid; place-items: center; font-weight: bold; font-size: 1.2rem; }
    .process-infographic h4 { font-size: 1.2rem; color: var(--secondary-color); margin: 0 0 0.5rem; }
    .process-infographic p { font-size: 1rem; color: #555; margin: 0; }

    /* 4. Mini Gallery */
    .gallery {
      background-color: var(--background-color);
    }
    .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
    .gallery-item {
      background-color: #fff;
      border-radius: 8px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 220px; /* Fixed height for consistency */
      padding: 0.5rem;
    }
    .gallery-grid img { 
      width: 100%; 
      height: 100%; 
      object-fit: contain; /* Make sure gallery images are also contained */
      border-radius: 8px; 
      transition: transform 0.3s ease; 
      cursor: pointer; 
    }
    .gallery-grid img:hover { transform: scale(1.05); }

    /* 5. Final CTA */
    .final-cta { background-color: var(--primary-color); color: white; text-align: center; }
    .final-cta h2, .final-cta p { color: white; }
    .final-cta p { max-width: 600px; margin: 0 auto 2rem; opacity: 0.9; }
    .final-cta .cta-button {
        background-color: white;
        color: var(--primary-color);
        border-radius: 50px;
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: 700;
        transition: all 0.3s ease;
        padding: 1rem 2.5rem; 
        border: 2px solid white;
    }
    .final-cta .cta-button:hover { 
        background-color: transparent; 
        color: white; 
    }

    /* Responsive */
    @media (max-width: 992px) {
      .product-grid { grid-template-columns: 1fr; }
      .product-image { height: auto; min-height: 250px; margin-bottom: 2rem; }
      .product-image i { font-size: 10rem; }
      .product-image img.service-icon-image { max-height: 250px; }
      .product-details .title { font-size: 2.5rem; }
    }
    @media (max-width: 768px) {
      .grid-two { grid-template-columns: 1fr; }
      section { padding: 3.5rem 0; }
      h2 { font-size: 2.2rem; }
      .product-details .price { font-size: 2rem; }
    }
  </style>
</Layout>
